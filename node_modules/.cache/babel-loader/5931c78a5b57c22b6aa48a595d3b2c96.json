{"ast":null,"code":"/*!\n * lightgallery | 2.3.0 | October 28th 2021\n * http://www.lightgalleryjs.com/\n * Copyright (c) 2020 Sachin Neravath;\n * @license GPLv3\n */\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\nvar __assign = function () {\n  __assign = Object.assign || function __assign(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n/**\r\n * List of lightGallery events\r\n * All events should be documented here\r\n * Below interfaces are used to build the website documentations\r\n * */\n\n\nvar lGEvents = {\n  afterAppendSlide: 'lgAfterAppendSlide',\n  init: 'lgInit',\n  hasVideo: 'lgHasVideo',\n  containerResize: 'lgContainerResize',\n  updateSlides: 'lgUpdateSlides',\n  afterAppendSubHtml: 'lgAfterAppendSubHtml',\n  beforeOpen: 'lgBeforeOpen',\n  afterOpen: 'lgAfterOpen',\n  slideItemLoad: 'lgSlideItemLoad',\n  beforeSlide: 'lgBeforeSlide',\n  afterSlide: 'lgAfterSlide',\n  posterClick: 'lgPosterClick',\n  dragStart: 'lgDragStart',\n  dragMove: 'lgDragMove',\n  dragEnd: 'lgDragEnd',\n  beforeNextSlide: 'lgBeforeNextSlide',\n  beforePrevSlide: 'lgBeforePrevSlide',\n  beforeClose: 'lgBeforeClose',\n  afterClose: 'lgAfterClose',\n  rotateLeft: 'lgRotateLeft',\n  rotateRight: 'lgRotateRight',\n  flipHorizontal: 'lgFlipHorizontal',\n  flipVertical: 'lgFlipVertical'\n};\nvar rotateSettings = {\n  rotate: true,\n  rotateSpeed: 400,\n  rotateLeft: true,\n  rotateRight: true,\n  flipHorizontal: true,\n  flipVertical: true\n};\n\nvar Rotate =\n/** @class */\nfunction () {\n  function Rotate(instance, $LG) {\n    // get lightGallery core plugin instance\n    this.core = instance;\n    this.$LG = $LG; // extend module default settings with lightGallery core settings\n\n    this.settings = __assign(__assign({}, rotateSettings), this.core.settings);\n    return this;\n  }\n\n  Rotate.prototype.buildTemplates = function () {\n    var rotateIcons = '';\n\n    if (this.settings.flipVertical) {\n      rotateIcons += '<button type=\"button\" id=\"lg-flip-ver\" aria-label=\"flip vertical\" class=\"lg-flip-ver lg-icon\"></button>';\n    }\n\n    if (this.settings.flipHorizontal) {\n      rotateIcons += '<button type=\"button\" id=\"lg-flip-hor\" aria-label=\"Flip horizontal\" class=\"lg-flip-hor lg-icon\"></button>';\n    }\n\n    if (this.settings.rotateLeft) {\n      rotateIcons += '<button type=\"button\" id=\"lg-rotate-left\" aria-label=\"Rotate left\" class=\"lg-rotate-left lg-icon\"></button>';\n    }\n\n    if (this.settings.rotateRight) {\n      rotateIcons += '<button type=\"button\" id=\"lg-rotate-right\" aria-label=\"Rotate right\" class=\"lg-rotate-right lg-icon\"></button>';\n    }\n\n    this.core.$toolbar.append(rotateIcons);\n  };\n\n  Rotate.prototype.init = function () {\n    var _this = this;\n\n    if (!this.settings.rotate) {\n      return;\n    }\n\n    this.buildTemplates(); // Save rotate config for each item to persist its rotate, flip values\n    // even after navigating to diferent slides\n\n    this.rotateValuesList = {}; // event triggered after appending slide content\n\n    this.core.LGel.on(lGEvents.afterAppendSlide + \".rotate\", function (event) {\n      var index = event.detail.index;\n\n      var imageWrap = _this.core.getSlideItem(index).find('.lg-img-wrap').first();\n\n      imageWrap.wrap('lg-img-rotate');\n\n      _this.core.getSlideItem(_this.core.index).find('.lg-img-rotate').css('transition-duration', _this.settings.rotateSpeed + 'ms');\n    });\n    this.core.outer.find('#lg-rotate-left').first().on('click.lg', this.rotateLeft.bind(this));\n    this.core.outer.find('#lg-rotate-right').first().on('click.lg', this.rotateRight.bind(this));\n    this.core.outer.find('#lg-flip-hor').first().on('click.lg', this.flipHorizontal.bind(this));\n    this.core.outer.find('#lg-flip-ver').first().on('click.lg', this.flipVertical.bind(this)); // Reset rotate on slide change\n\n    this.core.LGel.on(lGEvents.beforeSlide + \".rotate\", function (event) {\n      if (!_this.rotateValuesList[event.detail.index]) {\n        _this.rotateValuesList[event.detail.index] = {\n          rotate: 0,\n          flipHorizontal: 1,\n          flipVertical: 1\n        };\n      }\n    });\n  };\n\n  Rotate.prototype.applyStyles = function () {\n    var $image = this.core.getSlideItem(this.core.index).find('.lg-img-rotate').first();\n    $image.css('transform', 'rotate(' + this.rotateValuesList[this.core.index].rotate + 'deg)' + ' scale3d(' + this.rotateValuesList[this.core.index].flipHorizontal + ', ' + this.rotateValuesList[this.core.index].flipVertical + ', 1)');\n  };\n\n  Rotate.prototype.rotateLeft = function () {\n    this.rotateValuesList[this.core.index].rotate -= 90;\n    this.applyStyles();\n    this.triggerEvents(lGEvents.rotateLeft, {\n      rotate: this.rotateValuesList[this.core.index].rotate\n    });\n  };\n\n  Rotate.prototype.rotateRight = function () {\n    this.rotateValuesList[this.core.index].rotate += 90;\n    this.applyStyles();\n    this.triggerEvents(lGEvents.rotateRight, {\n      rotate: this.rotateValuesList[this.core.index].rotate\n    });\n  };\n\n  Rotate.prototype.getCurrentRotation = function (el) {\n    if (!el) {\n      return 0;\n    }\n\n    var st = this.$LG(el).style();\n    var tm = st.getPropertyValue('-webkit-transform') || st.getPropertyValue('-moz-transform') || st.getPropertyValue('-ms-transform') || st.getPropertyValue('-o-transform') || st.getPropertyValue('transform') || 'none';\n\n    if (tm !== 'none') {\n      var values = tm.split('(')[1].split(')')[0].split(',');\n\n      if (values) {\n        var angle = Math.round(Math.atan2(values[1], values[0]) * (180 / Math.PI));\n        return angle < 0 ? angle + 360 : angle;\n      }\n    }\n\n    return 0;\n  };\n\n  Rotate.prototype.flipHorizontal = function () {\n    var rotateEl = this.core.getSlideItem(this.core.index).find('.lg-img-rotate').first().get();\n    var currentRotation = this.getCurrentRotation(rotateEl);\n    var rotateAxis = 'flipHorizontal';\n\n    if (currentRotation === 90 || currentRotation === 270) {\n      rotateAxis = 'flipVertical';\n    }\n\n    this.rotateValuesList[this.core.index][rotateAxis] *= -1;\n    this.applyStyles();\n    this.triggerEvents(lGEvents.flipHorizontal, {\n      flipHorizontal: this.rotateValuesList[this.core.index][rotateAxis]\n    });\n  };\n\n  Rotate.prototype.flipVertical = function () {\n    var rotateEl = this.core.getSlideItem(this.core.index).find('.lg-img-rotate').first().get();\n    var currentRotation = this.getCurrentRotation(rotateEl);\n    var rotateAxis = 'flipVertical';\n\n    if (currentRotation === 90 || currentRotation === 270) {\n      rotateAxis = 'flipHorizontal';\n    }\n\n    this.rotateValuesList[this.core.index][rotateAxis] *= -1;\n    this.applyStyles();\n    this.triggerEvents(lGEvents.flipVertical, {\n      flipVertical: this.rotateValuesList[this.core.index][rotateAxis]\n    });\n  };\n\n  Rotate.prototype.triggerEvents = function (event, detail) {\n    var _this = this;\n\n    setTimeout(function () {\n      _this.core.LGel.trigger(event, detail);\n    }, this.settings.rotateSpeed + 10);\n  };\n\n  Rotate.prototype.isImageOrientationChanged = function () {\n    var rotateValue = this.rotateValuesList[this.core.index];\n    var isRotated = Math.abs(rotateValue.rotate) % 360 !== 0;\n    var ifFlippedHor = rotateValue.flipHorizontal < 0;\n    var ifFlippedVer = rotateValue.flipVertical < 0;\n    return isRotated || ifFlippedHor || ifFlippedVer;\n  };\n\n  Rotate.prototype.closeGallery = function () {\n    if (this.isImageOrientationChanged()) {\n      this.core.getSlideItem(this.core.index).css('opacity', 0);\n    }\n\n    this.rotateValuesList = {};\n  };\n\n  Rotate.prototype.destroy = function () {\n    // Unbind all events added by lightGallery rotate plugin\n    this.core.LGel.off('.lg.rotate');\n    this.core.LGel.off('.rotate');\n  };\n\n  return Rotate;\n}();\n\nexport default Rotate;","map":{"version":3,"sources":["../../../src/lg-events.ts","../../../src/plugins/rotate/lg-rotate-settings.ts","../../../src/plugins/rotate/lg-rotate.ts"],"names":[],"mappings":"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","sourcesContent":["import { LightGallery } from './lightgallery';\nimport { VideoSource } from './plugins/video/types';\n\n/**\n * List of lightGallery events\n * All events should be documented here\n * Below interfaces are used to build the website documentations\n * */\nexport const lGEvents: {\n    [key: string]: string;\n} = {\n    afterAppendSlide: 'lgAfterAppendSlide',\n    init: 'lgInit',\n    hasVideo: 'lgHasVideo',\n    containerResize: 'lgContainerResize',\n    updateSlides: 'lgUpdateSlides',\n    afterAppendSubHtml: 'lgAfterAppendSubHtml',\n    beforeOpen: 'lgBeforeOpen',\n    afterOpen: 'lgAfterOpen',\n    slideItemLoad: 'lgSlideItemLoad',\n    beforeSlide: 'lgBeforeSlide',\n    afterSlide: 'lgAfterSlide',\n    posterClick: 'lgPosterClick',\n    dragStart: 'lgDragStart',\n    dragMove: 'lgDragMove',\n    dragEnd: 'lgDragEnd',\n    beforeNextSlide: 'lgBeforeNextSlide',\n    beforePrevSlide: 'lgBeforePrevSlide',\n    beforeClose: 'lgBeforeClose',\n    afterClose: 'lgAfterClose',\n    rotateLeft: 'lgRotateLeft',\n    rotateRight: 'lgRotateRight',\n    flipHorizontal: 'lgFlipHorizontal',\n    flipVertical: 'lgFlipVertical',\n};\n\n/**\n * Fired only once when lightGallery is initialized\n * @name lgInit\n * @method onInit\n * @example\n *   const lg = document.getElementById('custom-events-demo');\n *   // Perform any action on lightGallery initialization.\n *   // Init event returns the plugin instance that can be used to call any lightGalley public method\n *   let pluginInstance = null;\n *   lg.addEventListener('lgInit', (event) => {\n *      pluginInstance = event.detail.instance;\n *   });\n *   lightGallery(lg);\n * @see <a href=\"/docs/methods\">Methods<a>\n */\nexport interface InitDetail {\n    /**\n     * lightGallery plugin instance\n     */\n    instance: LightGallery;\n}\n\n/**\n * Fired when the slide content has been inserted into it's slide container.\n * @name lgAfterAppendSlide\n * @method onAfterAppendSlide\n */\nexport interface AfterAppendSlideEventDetail {\n    /**\n     * Index of the slide\n     */\n    index: number;\n}\n\n/**\n * Fired immediately before opening the gallery\n * @name lgBeforeOpen\n * @method onBeforeOpen\n */\nexport interface BeforeOpenDetail {}\n\n/**\n * Fired immediately after opening the gallery\n * @name lgAfterOpen\n * @method onAfterOpen\n */\nexport interface AfterOpenDetail {}\n\n/**\n * Fired once the media inside the slide has been completely loaded .\n * @name lgSlideItemLoad\n * @method onSlideItemLoad\n */\nexport interface SlideItemLoadDetail {\n    /**\n     * Index of the slide\n     */\n    index: number;\n    /**\n     * For the first slide, lightGallery adds some delay for displaying the loaded slide item.\n     * This delay is required for the transition effect when the slide item is displayed\n     * Respect the delay when you use this event\n     */\n    delay: number;\n\n    // Will be true for the first slide\n    isFirstSlide: boolean;\n}\n\n/**\n * Fired immediately before each slide transition.\n * @name lgBeforeSlide\n * @method onBeforeSlide\n * @example\n *   const lg = document.getElementById('custom-events-demo');\n *   // Perform any action before each slide transition\n *   lg.addEventListener('lgBeforeSlide', (event) => {\n *       const { index, prevIndex } = event.detail;\n *       alert(index, prevIndex);\n *   });\n *   lightGallery(lg);\n */\nexport interface BeforeSlideDetail {\n    /**\n     * Index of the previous slide\n     */\n    prevIndex: number;\n    /**\n     * Index of the slide\n     */\n    index: number;\n    /**\n     * true if slide function called via touch event or mouse drag\n     */\n    fromTouch: boolean;\n    /**\n     * true if slide function called via thumbnail click\n     */\n    fromThumb: boolean;\n}\n\n/**\n * Fired immediately after each slide transition.\n * @name lgAfterSlide\n * @method onAfterSlide\n */\nexport interface AfterSlideDetail {\n    /**\n     * Index of the previous slide\n     */\n    prevIndex: number;\n    /**\n     * Index of the slide\n     */\n    index: number;\n    /**\n     * true if slide function called via touch event or mouse drag\n     */\n    fromTouch: boolean;\n    /**\n     * true if slide function called via thumbnail click\n     */\n    fromThumb: boolean;\n}\n\n/**\n * Fired when the video poster is clicked.\n * @name lgPosterClick\n * @method onPosterClick\n */\nexport interface PosterClickDetail {}\n\n/**\n * Fired when the drag event to move to different slide starts.\n * @name lgDragStart\n * @method onDragStart\n */\nexport interface DragStartDetail {}\n\n/**\n * Fired periodically during the drag operation.\n * @name lgDragMove\n * @method onDragMove\n */\nexport interface DragMoveDetail {}\n\n/**\n * Fired when the user has finished the drag operation\n * @name lgDragEnd\n * @method onDragEnd\n */\nexport interface DragEndDetail {}\n\n/**\n * Fired immediately before the start of the close process.\n * @name lgBeforeClose\n * @method onBeforeClose\n */\nexport interface BeforeCloseDetail {}\n\n/**\n * Fired immediately once lightGallery is closed.\n * @name lgAfterClose\n * @method onAfterClose\n */\nexport interface AfterCloseDetail {\n    /**\n     * lightGallery plugin instance\n     */\n    instance: LightGallery;\n}\n\n/**\n * Fired immediately before each \"next\" slide transition\n * @name lgBeforeNextSlide\n * @method onBeforeNextSlide\n */\nexport interface BeforeNextSlideDetail {\n    /**\n     * Index of the slide\n     */\n    index: number;\n    /**\n     * true if slide function called via touch event or mouse drag\n     */\n    fromTouch: boolean;\n}\n\n/**\n * Fired immediately before each \"prev\" slide transition\n * @name lgBeforePrevSlide\n * @method onBeforePrevSlide\n */\nexport interface BeforePrevSlideDetail {\n    /**\n     * Index of the slide\n     */\n    index: number;\n    /**\n     * true if slide function called via touch event or mouse drag\n     */\n    fromTouch: boolean;\n}\n\n/**\n * Fired when the sub-html content (ex : title/ description) has been appended into the slide.\n * @name lgAfterAppendSubHtml\n * @method onAfterAppendSubHtml\n */\nexport interface AfterAppendSubHtmlDetail {\n    /**\n     * Index of the slide\n     */\n    index: number;\n}\n\n/**\n * Fired when the lightGallery container has been resized.\n * @name lgContainerResize\n * @method onContainerResize\n */\nexport interface ContainerResizeDetail {\n    /**\n     * Index of the slide\n     */\n    index: number;\n}\n\n/**\n * Fired when lightGallery detects video slide\n * @name lgHasVideo\n * @method onHasVideo\n */\nexport interface HasVideoDetail {\n    /**\n     * Index of the slide,\n     */\n    index: number;\n    /**\n     * Video source\n     */\n    src: string;\n    /**\n     * HTML5 video source if available\n     * <p>\n       HTML5 video source = source: {\n            src: string;\n            type: string;\n        }[];\n        attributes: HTMLVideoElement;\n     * </p>\n     */\n    html5Video: VideoSource;\n    /**\n     * True if video has poster\n     */\n    hasPoster: boolean;\n}\n","export interface RotateSettings {\n    /**\n     * Enable/Disable rotate option\n     */\n    rotate: boolean;\n\n    /**\n     * Rotate speed in milliseconds\n     */\n    rotateSpeed: number;\n\n    /**\n     * Enable rotate left.\n     */\n    rotateLeft: boolean;\n\n    /**\n     * Enable rotate right.\n     */\n    rotateRight: boolean;\n\n    /**\n     * Enable flip horizontal.\n     */\n    flipHorizontal: boolean;\n\n    /**\n     * Enable flip vertical.\n     */\n    flipVertical: boolean;\n}\nexport const rotateSettings = {\n    rotate: true,\n    rotateSpeed: 400,\n    rotateLeft: true,\n    rotateRight: true,\n    flipHorizontal: true,\n    flipVertical: true,\n};\n","import { lGEvents } from '../../lg-events';\nimport { LgQuery } from '../../lgQuery';\nimport { LightGallery } from '../../lightgallery';\nimport { rotateSettings, RotateSettings } from './lg-rotate-settings';\n\nexport default class Rotate {\n    core: LightGallery;\n    settings: RotateSettings;\n    rotateValuesList!: {\n        [key: string]: any;\n    };\n    private $LG!: LgQuery;\n    constructor(instance: LightGallery, $LG: LgQuery) {\n        // get lightGallery core plugin instance\n        this.core = instance;\n        this.$LG = $LG;\n        // extend module default settings with lightGallery core settings\n        this.settings = { ...rotateSettings, ...this.core.settings };\n\n        return this;\n    }\n    buildTemplates(): void {\n        let rotateIcons = '';\n        if (this.settings.flipVertical) {\n            rotateIcons +=\n                '<button type=\"button\" id=\"lg-flip-ver\" aria-label=\"flip vertical\" class=\"lg-flip-ver lg-icon\"></button>';\n        }\n        if (this.settings.flipHorizontal) {\n            rotateIcons +=\n                '<button type=\"button\" id=\"lg-flip-hor\" aria-label=\"Flip horizontal\" class=\"lg-flip-hor lg-icon\"></button>';\n        }\n        if (this.settings.rotateLeft) {\n            rotateIcons +=\n                '<button type=\"button\" id=\"lg-rotate-left\" aria-label=\"Rotate left\" class=\"lg-rotate-left lg-icon\"></button>';\n        }\n        if (this.settings.rotateRight) {\n            rotateIcons +=\n                '<button type=\"button\" id=\"lg-rotate-right\" aria-label=\"Rotate right\" class=\"lg-rotate-right lg-icon\"></button>';\n        }\n        this.core.$toolbar.append(rotateIcons);\n    }\n\n    init(): void {\n        if (!this.settings.rotate) {\n            return;\n        }\n        this.buildTemplates();\n\n        // Save rotate config for each item to persist its rotate, flip values\n        // even after navigating to diferent slides\n        this.rotateValuesList = {};\n\n        // event triggered after appending slide content\n        this.core.LGel.on(`${lGEvents.afterAppendSlide}.rotate`, (event) => {\n            const { index } = event.detail;\n            const imageWrap = this.core\n                .getSlideItem(index)\n                .find('.lg-img-wrap')\n                .first();\n\n            imageWrap.wrap('lg-img-rotate');\n            this.core\n                .getSlideItem(this.core.index)\n                .find('.lg-img-rotate')\n                .css('transition-duration', this.settings.rotateSpeed + 'ms');\n        });\n\n        this.core.outer\n            .find('#lg-rotate-left')\n            .first()\n            .on('click.lg', this.rotateLeft.bind(this));\n\n        this.core.outer\n            .find('#lg-rotate-right')\n            .first()\n            .on('click.lg', this.rotateRight.bind(this));\n\n        this.core.outer\n            .find('#lg-flip-hor')\n            .first()\n            .on('click.lg', this.flipHorizontal.bind(this));\n\n        this.core.outer\n            .find('#lg-flip-ver')\n            .first()\n            .on('click.lg', this.flipVertical.bind(this));\n\n        // Reset rotate on slide change\n        this.core.LGel.on(`${lGEvents.beforeSlide}.rotate`, (event) => {\n            if (!this.rotateValuesList[event.detail.index]) {\n                this.rotateValuesList[event.detail.index] = {\n                    rotate: 0,\n                    flipHorizontal: 1,\n                    flipVertical: 1,\n                };\n            }\n        });\n    }\n\n    applyStyles(): void {\n        const $image = this.core\n            .getSlideItem(this.core.index)\n            .find('.lg-img-rotate')\n            .first();\n\n        $image.css(\n            'transform',\n            'rotate(' +\n                this.rotateValuesList[this.core.index].rotate +\n                'deg)' +\n                ' scale3d(' +\n                this.rotateValuesList[this.core.index].flipHorizontal +\n                ', ' +\n                this.rotateValuesList[this.core.index].flipVertical +\n                ', 1)',\n        );\n    }\n\n    rotateLeft(): void {\n        this.rotateValuesList[this.core.index].rotate -= 90;\n        this.applyStyles();\n        this.triggerEvents(lGEvents.rotateLeft, {\n            rotate: this.rotateValuesList[this.core.index].rotate,\n        });\n    }\n\n    rotateRight(): void {\n        this.rotateValuesList[this.core.index].rotate += 90;\n        this.applyStyles();\n        this.triggerEvents(lGEvents.rotateRight, {\n            rotate: this.rotateValuesList[this.core.index].rotate,\n        });\n    }\n\n    getCurrentRotation(el: HTMLElement): number {\n        if (!el) {\n            return 0;\n        }\n        const st = this.$LG(el).style();\n        const tm =\n            st.getPropertyValue('-webkit-transform') ||\n            st.getPropertyValue('-moz-transform') ||\n            st.getPropertyValue('-ms-transform') ||\n            st.getPropertyValue('-o-transform') ||\n            st.getPropertyValue('transform') ||\n            'none';\n        if (tm !== 'none') {\n            const values = tm.split('(')[1].split(')')[0].split(',') as any;\n            if (values) {\n                const angle = Math.round(\n                    Math.atan2(values[1], values[0]) * (180 / Math.PI),\n                );\n                return angle < 0 ? angle + 360 : angle;\n            }\n        }\n        return 0;\n    }\n\n    flipHorizontal(): void {\n        const rotateEl = this.core\n            .getSlideItem(this.core.index)\n            .find('.lg-img-rotate')\n            .first()\n            .get();\n        const currentRotation = this.getCurrentRotation(rotateEl);\n        let rotateAxis = 'flipHorizontal';\n        if (currentRotation === 90 || currentRotation === 270) {\n            rotateAxis = 'flipVertical';\n        }\n        this.rotateValuesList[this.core.index][rotateAxis] *= -1;\n        this.applyStyles();\n        this.triggerEvents(lGEvents.flipHorizontal, {\n            flipHorizontal: this.rotateValuesList[this.core.index][rotateAxis],\n        });\n    }\n\n    flipVertical(): void {\n        const rotateEl = this.core\n            .getSlideItem(this.core.index)\n            .find('.lg-img-rotate')\n            .first()\n            .get();\n        const currentRotation = this.getCurrentRotation(rotateEl);\n        let rotateAxis = 'flipVertical';\n        if (currentRotation === 90 || currentRotation === 270) {\n            rotateAxis = 'flipHorizontal';\n        }\n        this.rotateValuesList[this.core.index][rotateAxis] *= -1;\n\n        this.applyStyles();\n\n        this.triggerEvents(lGEvents.flipVertical, {\n            flipVertical: this.rotateValuesList[this.core.index][rotateAxis],\n        });\n    }\n\n    triggerEvents(event: string, detail: any): void {\n        setTimeout(() => {\n            this.core.LGel.trigger(event, detail);\n        }, this.settings.rotateSpeed + 10);\n    }\n\n    isImageOrientationChanged(): boolean {\n        const rotateValue = this.rotateValuesList[this.core.index];\n        const isRotated = Math.abs(rotateValue.rotate) % 360 !== 0;\n        const ifFlippedHor = rotateValue.flipHorizontal < 0;\n        const ifFlippedVer = rotateValue.flipVertical < 0;\n        return isRotated || ifFlippedHor || ifFlippedVer;\n    }\n\n    closeGallery(): void {\n        if (this.isImageOrientationChanged()) {\n            this.core.getSlideItem(this.core.index).css('opacity', 0);\n        }\n        this.rotateValuesList = {};\n    }\n\n    destroy(): void {\n        // Unbind all events added by lightGallery rotate plugin\n        this.core.LGel.off('.lg.rotate');\n        this.core.LGel.off('.rotate');\n    }\n}\n"]},"metadata":{},"sourceType":"module"}